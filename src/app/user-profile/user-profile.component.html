<div class="profile-page">
  <!-- Profile Section -->
  <div class="profile-section" *ngIf="profilepop">
    <div class="profile-info-container">
      <div class="username-section">
        <h1 class="username">Bill Smith</h1>
        <span><i class="bi bi-chevron-compact-down"></i></span>
      </div>
      <div class="edit-profile-btn" (click)="editProfile()">
        <i class="bi bi-pencil"></i> Edit Profile
      </div>
    </div>

    <div class="profile-header">
      <div class="profile-left">
        <div class="profile-image-container">
          <img src="../../assets/profile/7847055.jpg" alt="Profile Image" class="profile-image" />
          <div class="add-icon"><i class="bi bi-plus"></i></div>
        </div>
      </div>

      <div class="profile-bottom">
        <div class="profile-stats">
          <div class="stat-item">
            <h3>{{ uploadedCount }}</h3>
            <p>Posts</p>
          </div>
          <div class="stat-item">
            <h3>0</h3>
            <p>Followers</p>
          </div>
          <div class="stat-item">
            <h3>0</h3>
            <p>Following</p>
          </div>
        </div>
      </div>
    </div>

    <div class="name-bio-container">
      <h1 class="name">Bill Smith</h1>
      <p class="bio">{{ bio }}</p>
    </div>
  </div>

  <!-- Upload Section -->
  <div style="border-top: 1px solid pink;width: 100%;" *ngIf="showUpload">
    <div class="product-toggle">
      <div class="toggle-item" (click)="showUploaded = true">Uploaded</div>
      <div class="toggle-item" (click)="showUploaded = false">Saved</div>
    </div>

    <div class="uploaded-products" *ngIf="showUploaded">
      <div *ngFor="let product of uploadedProducts" class="product-item">
        <img [src]="product.image" alt="{{ product.title }}" class="product-image" />
      </div>
    </div>

    <div class="saved-list" *ngIf="!showUploaded">
      <div *ngFor="let product of savedProducts" class="product-item">
        <img [src]="product.image" alt="{{ product.title }}" class="product-image" />
      </div>
    </div>
  </div>
</div>

<!-- Edit Profile Popup -->
<div *ngIf="editProfilepop" style="color: black;">
  <div class="profile-box">
    <h2>Edit Profile</h2>
    <form [formGroup]="editProfileForm" (ngSubmit)="updateProfile()">
      <!-- Name Field -->
      <div class="user-box">
        <input type="text" formControlName="name" required />
        <label>Name</label>
      </div>
      <div
        *ngIf="editProfileForm.controls.name.invalid && (editProfileForm.controls.name.touched || editProfileForm.controls.name.dirty)">
        <small [ngClass]="{'error-message': true, 'active': editProfileForm.controls.name.errors?.required}">
          Name is required.
        </small>
      </div>

      <!-- Username Field -->
      <div class="user-box">
        <input type="text" formControlName="username" required />
        <label>Username</label>
      </div>
      <div
        *ngIf="editProfileForm.controls.username.invalid && (editProfileForm.controls.username.touched || editProfileForm.controls.username.dirty)">
        <small [ngClass]="{'error-message': true, 'active': editProfileForm.controls.username.errors?.required}">
          Username is required.
        </small>
        <small [ngClass]="{'error-message': true, 'active': editProfileForm.controls.username.errors?.pattern}">
          Invalid username format.
        </small>
      </div>

      <!-- Website Field -->
      <div class="user-box">
        <input type="text" formControlName="website" required />
        <label>Website</label>
      </div>
      <div
        *ngIf="editProfileForm.controls.website.invalid && (editProfileForm.controls.website.touched || editProfileForm.controls.website.dirty)">
        <small [ngClass]="{'error-message': true, 'active': editProfileForm.controls.website.errors?.required}">
          Website is required.
        </small>
      </div>

      <!-- Bio Field -->
      <div class="user-box">
        <input type="text" formControlName="bio" maxlength="120" />
        <label>Bio</label>
      </div>

      <div *ngIf="serverError" class="error-message">
        <small>{{ serverError }}</small>
      </div>

      <button type="submit" class="update-profile-btn">UPDATE PROFILE</button>
    </form>
  </div>
</div>